---
title: "Dangerous Items"
output: html_notebook
---

```{r load-libs}
library(data.world)
suppressPackageStartupMessages(library(tidyverse))
```


This is an automatically generated notebook for the `Gun Deaths in America` dataset found at:
https://data.world/azel/gun-deaths-in-america, showcasing the use of the `data.world` R package.

## Setup

For first time users, before running any chunks in this notebook:

* Install the `data.world` R package:
  ```
  devtools::install_github("datadotworld/data.world-r", build_vignettes = TRUE, force = TRUE)
  ```
* Get your API authentication token at https://data.world/settings/advanced
* Configure the `data.world` package:
  ```
  data.world::set_config(data.world::save_config(auth_token = "YOUR TOKEN"))
  ```

Configuration will be saved at `~/.dw/config` and automatically applied to all future R sessions.

## Reading in the data


```{sql eval = FALSE}
SELECT COUNT(full_data.column_a), full_data.age, full_data.sex, full_data.race, full_data.intent, full_data.year
FROM full_data
GROUP BY full_data.age, full_data.sex, full_data.race, full_data.intent, full_data.year;
```


```{r read-dat}
url <- "https://query.data.world/s/usia7cr2a6ljbu6e3awwkkn3yq2yxv"

deaths <- readr::read_csv(url, col_types = cols(age = col_number(),
                                                count = col_number(), race = col_factor(levels = c("White", "Hispanic", "Native American/Native Alaskan", "Black", "Asian/Pacific Islander")), 
                                                sex = col_factor(levels = c("M", "F")),
                                                year = col_factor(levels = c("2012", "2013", "2014"))))

glimpse(deaths)
```

```{r age-year}
deaths %>%
  group_by(age, year) %>%
  summarise(age_total = sum(count))
```

```{r death-by-age, warning=FALSE}
deaths_age_year <- deaths %>%
  group_by(age, year) %>%
  summarise(total = sum(count))


ggplot(data = deaths_age_year) +
  geom_point(aes(x = age, y = total, colour = year)) +
  hrbrthemes::theme_ipsum_rc() +
  labs(caption = "Source: CDC gun-death data, 2012-2014.")
```

